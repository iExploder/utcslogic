# Wagon: 型安全性を持つSIMD命令を利用可能なDSL
<u>QI Quanyu</u> 亀山幸義 (筑波大学)

## 目的

* 高レベル関数型言語を用いてままSIMD命令付き実行効率高いコードの生成
* 型安全性低いSIMD組込み関数の不適切な利用を減らす

## SIMDとは？

* Single Instruction Multiple Dataの略称
* 一つの命令は複数のデータを扱える
* クロックサイクル数はスカラー命令と似ている
* x86系・組込みシステムなど多数のアーキテクチャが搭載

## 問題点

* コンパイラによる自動ベクトル化機能は完成度低い
  * 手動ベクトル化（一部でも）はより高い実行効率は可能
* C言語のSIMD組込み関数は型検査が非常に弱い
  * 整数SIMDベクトルは整数のビット数情報を持っていない
  * SIMD組込み関数の引数はメモリアラインメントが正しくなくてもコンパイルできる
    →実行時エラーになる
* SIMD組込み関数を使うC言語自体は暗黙的型変換が多い
* 手動でSIMD組込み関数を用いての最適化はデバッグ困難

## 先行研究[1] | HaskellのSIMDサポート

* ...

## 先行研究[2] | Accelerate

* ...

## Tagless-finalアプローチ

* ホスト言語の型システムによる最大限活用例
  * 最小限のコード量
  * 拡張は数箇所の書き直し不要→不具合が少ない

## Wagonコードの例

```ocaml
let wfunc_example = ...
(* ベクトルの内積 *)
```